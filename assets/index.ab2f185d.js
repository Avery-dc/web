var H=Object.defineProperty;var S=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var g=(e,t,s)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))N.call(t,s)&&g(e,s,t[s]);if(S)for(var s of S(t))G.call(t,s)&&g(e,s,t[s]);return e};var p=(e,t,s)=>(g(e,typeof t!="symbol"?t+"":t,s),s);import{a as E,c as C,u as k,d as I,m as B,b as R,r as x,e as q,o as _,f as h,g as a,t as P,p as j,h as D,i as T,F,j as M,k as z,l as V,n as W}from"./vendor.8baac448.js";const J=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}};J();function K(e,t=!0){let s=localStorage.getItem(e)||"{}";return t?JSON.parse(s):s}var f;(function(e){e.GET_AUTHENTICATION="isAuthenticated"})(f||(f={}));const Q={[f.GET_AUTHENTICATION]:e=>e.login},X="https://discord.com/api/v9",A=E.create({baseURL:X,timeout:20*1e3,method:"GET"});A.interceptors.request.use(e=>e,e=>Promise.reject(e));A.interceptors.response.use(e=>e,e=>(e.response&&e.response.data?console.error("[Axios Error]",`Code: ${e.response.status}, Message: ${e.response.data.message}`):console.error(e),Promise.reject(e)));class b{constructor(t,s=!0){p(this,"token");p(this,"Authorization");p(this,"BaseRequest");this.user=s,this.BaseRequest=A,this.init(t,s)}init(t,s=!0){t=t||localStorage.getItem("token")||sessionStorage.getItem("token")||"",this.token=t,this.Authorization=`${s?"Bearer":"Bot"} ${t}`,console.log(this.Authorization)}async getToken(t){let{data:s}=await E({url:"http://localhost:3001/services/discord-callback",method:"POST",data:{code:t,redirect_uri:"http://localhost:3000/discord-callback"}});return s.access_token?(this.token=s.access_token,s.access_token):s}getMe(){return this.BaseRequest(c({url:"/users/@me"},this.headers))}getGuilds(){return this.BaseRequest(c({url:"/users/@me/guilds"},this.headers))}getGuildChannel(t){return this.BaseRequest(c({url:`/guilds/${t}/channels`},this.headers))}getGuildMembers(t){return this.BaseRequest(c({url:`/guilds/${t}/members`},this.headers))}getGuildRoles(t){return this.BaseRequest(c({url:`/guilds/${t}/roles`},this.headers))}get headers(){return{headers:{Authorization:this.Authorization||""}}}}Object.assign(window,{DiscordApi:b});var u;(function(e){e.SET_AUTH_STATUS="SET_AUTH_STATUS",e.SET_AUTH_DATA="SET_AUTH_DATA"})(u||(u={}));const Y={[u.SET_AUTH_STATUS]:(e,t)=>e.login=t===void 0?!e.login:t,[u.SET_AUTH_DATA]:(e,t)=>e.userInfo=t},v=new b;var l;(function(e){e.LOGIN="loginCode",e.GET_INFO="getMe"})(l||(l={}));const Z={[l.GET_INFO]:async({commit:e},t)=>{v.init(t);let{data:s}=await v.getMe();return e(u.SET_AUTH_DATA,s),s},[l.LOGIN]:async({commit:e,dispatch:t},s)=>{let r=await v.getToken(s);if(typeof r=="string")return e(u.SET_AUTH_STATUS,!0),t(l.GET_INFO,r),r}},ee={login:!1,userInfo:{}},te={namespaced:!0,mutations:Y,getters:Q,state:ee,actions:Z};var d;(function(e){e.AUTH="auth"})(d||(d={}));const se=C({modules:{[d.AUTH]:te}}),y=Symbol("vue-store");function oe(){return console.log(k(y)),k(y)}var re="/web/assets/LogoLong.298e9c85.png";var $=(e,t)=>{const s=e.__vccOpts||e;for(const[r,o]of t)s[r]=o;return s};const ne=I({computed:c({},B(d.AUTH,{isAuthenticated:f.GET_AUTHENTICATION})),methods:c({},R(d.AUTH,[l.LOGIN,l.GET_INFO])),mounted(){let e=K("token");(e==null?void 0:e.access_token)&&this.getMe(e.access_token),addEventListener("get_dc_code",async t=>{var r,o;let s=t;((r=s==null?void 0:s.detail)==null?void 0:r.code)&&this.store.dispatch(`${[d.AUTH]}/${l.LOGIN}`,(o=s==null?void 0:s.detail)==null?void 0:o.code)})},setup(){const e=oe(),t=x(null),s=q(e.state.auth.userInfo),r="/web/",o=()=>window.open("https://discord.com/api/oauth2/authorize?client_id=863676847731376170&redirect_uri=http://localhost:3000/discord-callback&response_type=code&scope=identify+guilds+email","","width=500,height=620"),n=()=>t.value.classList.toggle("down");return Object.assign(window,{store:e}),{login:o,userEl:t,dc_data:s,BASE_URL:r,openLicks:n,store:e}}}),m=e=>(j("data-v-2b66c6d8"),e=e(),D(),e),ie={class:"flex flex-item-center"},ae=["href"],ce=m(()=>a("img",{src:re,alt:""},null,-1)),le=m(()=>a("p",null,"Avery",-1)),ue=[ce,le],de={class:"menu"},_e={class:"ul flex flex-item-center"},he={class:"user flex flex-item-center"},pe=["src"],fe=["textContent"],me=m(()=>a("i",{class:"arrow"},null,-1)),ge=m(()=>a("div",{class:"licks"},null,-1));function Te(e,t,s,r,o,n){return _(),h("header",ie,[a("a",{href:e.BASE_URL,class:"logo flex flex-item-center"},ue,8,ae),a("div",de,[a("div",_e,[a("div",he,[Object.keys(e.dc_data).length>0?(_(),h("div",{key:0,class:"flex flex-item-center is-login",onClick:t[0]||(t[0]=(...i)=>e.openLicks&&e.openLicks(...i)),ref:"userEl"},[a("img",{src:`https://cdn.discordapp.com/avatars/${e.dc_data.id}/${e.dc_data.avatar}.png`,class:"user-icon",width:"45",alt:""},null,8,pe),a("span",{class:"user-name",textContent:P(e.dc_data.username)},null,8,fe),me,ge],512)):(_(),h("div",{key:1,class:"login",onClick:t[1]||(t[1]=(...i)=>e.login&&e.login(...i))},"\u767B\u5165"))])])])])}var Ae=$(ne,[["render",Te],["__scopeId","data-v-2b66c6d8"]]);const ve={};function ye(e,t){return _(),h("footer")}var Se=$(ve,[["render",ye]]);const Ee={class:"wrapper"},ke=I({setup(e){return(t,s)=>{const r=M("router-view");return _(),h(F,null,[T(Ae),a("div",Ee,[T(r)]),T(Se)],64)}}}),Ie="modulepreload",w={},be="/web/",L=function(t,s){return!s||s.length===0?t():Promise.all(s.map(r=>{if(r=`${be}${r}`,r in w)return;w[r]=!0;const o=r.endsWith(".css"),n=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${n}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":Ie,o||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),o)return new Promise((O,U)=>{i.addEventListener("load",O),i.addEventListener("error",U)})})).then(()=>t())},$e=[{name:"Home",path:"/",component:()=>L(()=>import("./Home.d9aa609d.js"),["assets/Home.d9aa609d.js","assets/Home.2bd0fa25.css","assets/vendor.8baac448.js"])},{name:"discordCallback",path:"/discord-callback",component:()=>L(()=>import("./discord.28ab4a6b.js"),["assets/discord.28ab4a6b.js","assets/vendor.8baac448.js"])}],we=z({history:V("/web/"),routes:$e});W(ke).use(se,y).use(we).mount("#app");export{$ as _,re as a};
