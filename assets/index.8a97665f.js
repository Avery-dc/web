var R=Object.defineProperty;var x=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var A=(t,e,s)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,d=(t,e)=>{for(var s in e||(e={}))q.call(e,s)&&A(t,s,e[s]);if(x)for(var s of x(e))P.call(e,s)&&A(t,s,e[s]);return t};var g=(t,e,s)=>(A(t,typeof e!="symbol"?e+"":e,s),s);import{a as L,c as M,u as j,d as $,r as D,b as F,o as J,e as h,f as p,g as c,h as f,t as z,p as V,i as W,j as y,F as K,k as Q,l as X,m as Y,n as Z}from"./vendor.7b381d5f.js";const ee=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}};ee();var te="/web/assets/LogoLong.298e9c85.png";function se(t,e){localStorage.setItem(t,JSON.stringify(e))}function N(t,e=!0){let s=localStorage.getItem(t)||"{}";return e?JSON.parse(s):s}function oe(t,e){sessionStorage.setItem(t,JSON.stringify(e))}function re(t,e=!0){let s=sessionStorage.getItem(t)||"{}";return e?JSON.parse(s):s}var _;(function(t){t.SET_AUTH_STATUS="SET_AUTH_STATUS",t.SET_AUTH_DATA="SET_AUTH_DATA"})(_||(_={}));const ne={[_.SET_AUTH_STATUS]:(t,e)=>t.login=e===void 0?!t.login:e,[_.SET_AUTH_DATA]:(t,e)=>t.userInfo=e},ie="https://discord.com/api/v9",E=L.create({baseURL:ie,timeout:20*1e3,method:"GET"});E.interceptors.request.use(t=>t,t=>Promise.reject(t));E.interceptors.response.use(t=>t,t=>(t.response&&t.response.data?console.error("[Axios Error]",`Code: ${t.response.status}, Message: ${t.response.data.message}`):console.error(t),Promise.reject(t)));class U{constructor(e,s=!0){g(this,"token");g(this,"Authorization");g(this,"BaseRequest");this.user=s,this.BaseRequest=E,this.init(e,s)}getTokenJson(){return N("token")||re("token")}savaToken(e,s=!0){(e==null?void 0:e.error)||(s?se("token",e):oe("token",e))}init(e,s=!0){e||(e=this.getTokenJson()),typeof e!="string"&&e&&(this.savaToken(e),e=e==null?void 0:e.access_token),this.token=e,this.Authorization=`${s?"Bearer":"Bot"} ${e}`}async getToken(e){let{data:s}=await L({url:"http://localhost:3001/services/discord-callback",method:"POST",data:{code:e,redirect_uri:"http://localhost:3000/discord-callback"}});return this.savaToken(s),s.access_token?(this.token=s.access_token,s.access_token):s}getMe(){return this.BaseRequest(d({url:"/users/@me"},this.headers))}getGuilds(){return this.BaseRequest(d({url:"/users/@me/guilds"},this.headers))}getGuildChannel(e){return this.BaseRequest(d({url:`/guilds/${e}/channels`},this.headers))}getGuildMembers(e){return this.BaseRequest(d({url:`/guilds/${e}/members`},this.headers))}getGuildRoles(e){return this.BaseRequest(d({url:`/guilds/${e}/roles`},this.headers))}get headers(){return{headers:{Authorization:this.Authorization||""}}}}Object.assign(window,{DiscordApi:U});const k=new U;var l;(function(t){t.LOGIN="loginCode",t.GET_INFO="getMe"})(l||(l={}));const ce={[l.GET_INFO]:async({commit:t},e)=>{k.init(e);let{data:s}=await k.getMe();return t(_.SET_AUTH_DATA,s),s},[l.LOGIN]:async({commit:t,dispatch:e},s)=>{let r=await k.getToken(s);if(typeof r=="string")return t(_.SET_AUTH_STATUS,!0),e(l.GET_INFO,r),r}};var I;(function(t){t.GET_AUTHENTICATION="isAuthenticated"})(I||(I={}));const ae={[I.GET_AUTHENTICATION]:t=>t.login},le={login:!1,userInfo:void 0},ue={namespaced:!0,mutations:ne,getters:ae,state:le,actions:ce};var m;(function(t){t.AUTH="auth"})(m||(m={}));const de=M({modules:{[m.AUTH]:ue}}),H=Symbol("vue-store");function _e(){return j(H)}var C=(t,e)=>{const s=t.__vccOpts||t;for(const[r,o]of e)s[r]=o;return s};const T=t=>(V("data-v-330b2966"),t=t(),W(),t),he={class:"flex flex-item-center"},pe=["href"],fe=T(()=>c("img",{src:te,alt:""},null,-1)),me=T(()=>c("p",null,"Avery",-1)),ge=[fe,me],Te={class:"menu"},ve={class:"ul flex flex-item-center"},Se={class:"user flex flex-item-center"},Ae=["src"],ye=["textContent"],Ee=T(()=>c("i",{class:"arrow"},null,-1)),ke=T(()=>c("div",{class:"licks"},null,-1)),Ie=$({setup(t){const e=_e(),s=D(null),r=F(()=>e.state.auth.userInfo),o="/web/",n=()=>window.open("https://discord.com/api/oauth2/authorize?client_id=863676847731376170&redirect_uri=http://localhost:3000/discord-callback&response_type=code&scope=identify+guilds+email","","width=500,height=620"),i=()=>s.value.classList.toggle("down");Object.assign(window,{store:e});const v=a=>{e.dispatch(`${[m.AUTH]}/${l.LOGIN}`,a)},S=a=>{e.dispatch(`${m.AUTH}/${l.GET_INFO}`,a)};return J(()=>{let a=N("token");(a==null?void 0:a.access_token)&&S(a),addEventListener("get_dc_code",async b=>{var w,O;let u=b;((w=u==null?void 0:u.detail)==null?void 0:w.code)&&v((O=u==null?void 0:u.detail)==null?void 0:O.code)})}),(a,b)=>(h(),p("header",he,[c("a",{href:f(o),class:"logo flex flex-item-center"},ge,8,pe),c("div",Te,[c("div",ve,[c("div",Se,[f(r)?(h(),p("div",{key:0,class:"flex flex-item-center is-login",onClick:i,ref_key:"userEl",ref:s},[c("img",{src:`https://cdn.discordapp.com/avatars/${f(r).id}/${f(r).avatar}.png`,class:"user-icon",width:"45",alt:""},null,8,Ae),c("span",{class:"user-name",textContent:z(f(r).username)},null,8,ye),Ee,ke],512)):(h(),p("div",{key:1,class:"login",onClick:n},"\u767B\u5165"))])])])]))}});var be=C(Ie,[["__scopeId","data-v-330b2966"]]);const we={};function Oe(t,e){return h(),p("footer")}var xe=C(we,[["render",Oe]]);const Le={class:"wrapper"},$e=$({setup(t){return(e,s)=>{const r=Q("router-view");return h(),p(K,null,[y(be),c("div",Le,[y(r)]),y(xe)],64)}}}),Ne="modulepreload",G={},Ue="/web/",B=function(e,s){return!s||s.length===0?e():Promise.all(s.map(r=>{if(r=`${Ue}${r}`,r in G)return;G[r]=!0;const o=r.endsWith(".css"),n=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${n}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":Ne,o||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),o)return new Promise((v,S)=>{i.addEventListener("load",v),i.addEventListener("error",S)})})).then(()=>e())},He=[{name:"Home",path:"/",component:()=>B(()=>import("./Home.04d51335.js"),["assets/Home.04d51335.js","assets/Home.2bd0fa25.css","assets/vendor.7b381d5f.js"])},{name:"discordCallback",path:"/discord-callback",component:()=>B(()=>import("./discord.cc39b4a8.js"),["assets/discord.cc39b4a8.js","assets/vendor.7b381d5f.js"])}],Ce=X({history:Y("/web/"),routes:He});Z($e).use(de,H).use(Ce).mount("#app");export{C as _,te as a};
